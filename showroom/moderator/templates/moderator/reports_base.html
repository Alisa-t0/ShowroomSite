{% extends 'layout_m.html' %}

{% block title %}–ó–≤—ñ—Ç–∏{% endblock %}

{% block content %}
<h2 style="text-align: center; margin-bottom: 30px;">–ó–≤—ñ—Ç</h2>

<form method="get">
    <select name="report_type">
        <option value="">–û–±–µ—Ä—ñ—Ç—å –∑–≤—ñ—Ç</option>
        <option value="all_workers">–ü—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∏</option>
        <option value="all_cars">–ê–≤—Ç–æ–º–æ–±—ñ–ª—ñ</option>
        <option value="all_sales">–ü—Ä–æ–¥–∞–∂—ñ</option>
        <option value="sales_by_date">–ü—Ä–æ–¥–∞–∂—ñ –∑–∞ –¥–∞—Ç—É</option>
        <option value="sales_by_time_period">–ü—Ä–æ–¥–∞–∂—ñ –∑–∞ –ø–µ—Ä—ñ–æ–¥</option>
        <option value="sales_by_worker">–ü—Ä–æ–¥–∞–∂—ñ –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∞</option>
        <option value="bestseller_car_by_time_period">–ù–∞–π–ø–æ–ø—É–ª—è—Ä–Ω—ñ—à–∏–π –∞–≤—Ç–æ–º–æ–±—ñ–ª—å</option>
        <option value="top_seller_by_time_period">–ù–∞–π—É—Å–ø—ñ—à–Ω—ñ—à–∏–π –ø—Ä–æ–¥–∞–≤–µ—Ü—å</option>
        <option value="total_profit_by_time_period">–°—É–º–∞—Ä–Ω–∏–π –ø—Ä–∏–±—É—Ç–æ–∫</option>
    </select>


    <label>ID –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∞:</label>
    <select name="worker_id">
        <option value="">–û–±–µ—Ä—ñ—Ç—å –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∞</option>
        {% for worker in workers_list %}
            <option value="{{ worker.id }}">{{ worker.full_name }}</option>
        {% endfor %}
    </select>
    <label>–ü–æ—á–∞—Ç–∫–æ–≤–∞ –¥–∞—Ç–∞:</label>
    <input type="date" name="start_date">
    <label>–ö—ñ–Ω—Ü–µ–≤–∞ –¥–∞—Ç–∞:</label>
    <input type="date" name="end_date">

    <button type="submit">–ü–æ–∫–∞–∑–∞—Ç–∏</button>
</form>

<h2 style="text-align: center">{{ title }}</h2>
  {% if extra_info %}
      <div class="extra-info">
        {% if extra_info.car %}
          <h3>{{ extra_info.car.producer_name }} {{ extra_info.car.model }}</h3>
          <p>–ö—ñ–ª—å–∫—ñ—Å—Ç—å –ø—Ä–æ–¥–∞–∂—ñ–≤ –∑–∞ —Ü–µ–π —á–∞—Å:
            <span class="highlight">{{ extra_info.count }}</span>
          </p>

        {% elif extra_info.worker %}
          <h3>–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –ø—Ä–∞—Ü—ñ–≤–Ω–∏–∫–∞</h3>
          <p><strong>ID:</strong> {{ extra_info.worker.id }}</p>
          <p><strong>–ü–Ü–ë:</strong> {{ extra_info.worker.full_name }}</p>
          <p><strong>–ü–æ—Å–∞–¥–∞:</strong> {{ extra_info.worker.position }}</p>
          <p><strong>–¢–µ–ª–µ—Ñ–æ–Ω:</strong> {{ extra_info.worker.phone }}</p>
          <p><strong>Email:</strong> {{ extra_info.worker.email }}</p>
          <p><strong>–ü—Ä–∞—Ü—é—î –∑–∞—Ä–∞–∑:</strong>
            <span class="highlight">
              {% if extra_info.worker.is_active %}–¢–∞–∫{% else %}–ù—ñ{% endif %}
            </span>
          </p>
          <div class="profit">–ü—Ä–∏–±—É—Ç–æ–∫: {{ extra_info.worker_profit }} $</div>

        {% elif extra_info.profit %}
          <h3>üí∞ –ó–∞–≥–∞–ª—å–Ω–∏–π –ø—Ä–∏–±—É—Ç–æ–∫</h3>
          <div class="profit">{{ extra_info.profit }} $</div>
        {% endif %}
      </div>
    <h2 style="text-align: center; margin-bottom: 30px;">–°–ø–∏—Å–æ–∫ —É—Å—ñ—Ö –ø—Ä–æ–¥–∞–∂</h2>

  {% endif %}

{% if data %}
<table>
  <thead>
    <tr>
        {% block head_table %}
        {% endblock %}
    </tr>
  </thead>
  <tbody>
    <tr>
        {% for object in data %}
            {% block body_table %}
            {% endblock %}
         {% endfor %}
    </tr>
  </tbody>
    {% if extra_info.profit %}
      <tfoot>
        <tr style="font-weight: bold; background: #f9f9f9;">
            <td colspan="5" style="text-align: right;">–ó–∞–≥–∞–ª—å–Ω–∏–π –ø—Ä–∏–±—É—Ç–æ–∫:</td>
            <td>{{ extra_info.profit }} $</td>
        </tr>
      </tfoot>
    {% endif %}
</table>
{% else %}
  <p>–ù–µ–º–∞—î –¥–∞–Ω–∏—Ö –¥–ª—è –≤—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è.</p>
{% endif %}
{% endblock %}
